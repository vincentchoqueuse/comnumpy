
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>OFDM Chain Tutorial &#8212; comnumpy  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=c1e2a009" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.1.4/dist/mermaid-layout-elk.esm.min.mjs"></script>
    <script type="module">import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs";import elkLayouts from "https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.1.4/dist/mermaid-layout-elk.esm.min.mjs";mermaid.registerLayoutLoaders(elkLayouts);mermaid.initialize({startOnLoad:false});</script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
    <script type="module">
import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs";
window.addEventListener("load", () => mermaid.run());
</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/ofdm';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="PAPR in OFDM Communication" href="ofdm_papr.html" />
    <link rel="prev" title="AWGN Chain Tutorial" href="awgn.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.jpg" class="logo__image only-light" alt=""/>
    <img src="../_static/logo.jpg" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">Comnumpy</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/index.html">
    Getting Started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../documentation/index.html">
    Documentation
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/vincentchoqueuse/comnumpy.git" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/index.html">
    Getting Started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../documentation/index.html">
    Documentation
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/vincentchoqueuse/comnumpy.git" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="awgn.html">AWGN Chain Tutorial</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">OFDM Chain Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="ofdm_papr.html">PAPR in OFDM Communication</a></li>
<li class="toctree-l1"><a class="reference internal" href="mimo.html">MIMO Chain Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="optical_fiber_nonlinearity.html">Optical Fiber Link Simulation Tutorial</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Examples</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">OFDM Chain Tutorial</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="ofdm-chain-tutorial">
<h1>OFDM Chain Tutorial<a class="headerlink" href="#ofdm-chain-tutorial" title="Link to this heading">#</a></h1>
<p>This tutorial guides you through simulating a selective channel and comparing the performance of a Single Carrier (SC) system and an OFDM system using the  <code class="docutils literal notranslate"><span class="pre">comnumpy</span></code> library. You’ll learn how to:</p>
<ul class="simple">
<li><p>Define and simulate realistic communication channels.</p></li>
<li><p>Evaluate performance using Symbol Error Rate (SER).</p></li>
<li><p>Understand why OFDM performs better in multipath environments.</p></li>
</ul>
<p>This tutorial is suitable for both engineers and students interested in digital communications, and serves - as both a practical example and a theoretical insight.</p>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading">#</a></h2>
<p>Ensure you have the following Python libraries installed:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">numpy</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">matplotlib</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">comnumpy</span></code></p></li>
</ul>
</section>
<section id="simulation-setup">
<h2>Simulation Setup<a class="headerlink" href="#simulation-setup" title="Link to this heading">#</a></h2>
</section>
<section id="import-libraries">
<h2>1. Import Libraries<a class="headerlink" href="#import-libraries" title="Link to this heading">#</a></h2>
<p>Begin by importing the necessary libraries</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">comnumpy.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">Sequential</span><span class="p">,</span> <span class="n">Recorder</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">comnumpy.core.generators</span><span class="w"> </span><span class="kn">import</span> <span class="n">SymbolGenerator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">comnumpy.core.mappers</span><span class="w"> </span><span class="kn">import</span> <span class="n">SymbolMapper</span><span class="p">,</span> <span class="n">SymbolDemapper</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">comnumpy.core.channels</span><span class="w"> </span><span class="kn">import</span> <span class="n">AWGN</span><span class="p">,</span> <span class="n">FIRChannel</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">comnumpy.core.compensators</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearEqualizer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">comnumpy.core.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_alphabet</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">comnumpy.core.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">compute_ser</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">comnumpy.ofdm.chains</span><span class="w"> </span><span class="kn">import</span> <span class="n">OFDMTransmitter</span><span class="p">,</span> <span class="n">OFDMReceiver</span>
</pre></div>
</div>
</section>
<section id="define-simulation-parameters">
<h2>2. Define Simulation Parameters<a class="headerlink" href="#define-simulation-parameters" title="Link to this heading">#</a></h2>
<p>Let us define some communication parameters</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># parameters</span>
<span class="n">M</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">N_h</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">sigma2</span> <span class="o">=</span> <span class="mf">0.02</span>
<span class="n">alphabet</span> <span class="o">=</span> <span class="n">get_alphabet</span><span class="p">(</span><span class="s2">&quot;QAM&quot;</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>

<span class="c1"># generate a random selective channel</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N_h</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N_h</span><span class="p">))</span>
<span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>The two last lines define the taps of a frequency-selective multipath channel.
The first tap is normalized to 1 in order to preserve the overall channel energy.</p>
<p>Mathematically, the input–output relationship of such a channel is given by</p>
<div class="math notranslate nohighlight">
\[z[n] = h * x[n] + b[n] = \sum_{l=0}^{L_{\text{tap}}-1} h[l]\,x[n-l] + b[n]\]</div>
<p>where <span class="math notranslate nohighlight">\(*\)</span> denotes the convolution operator.
This type of channel introduces inter-symbol interference (ISI) in single-carrier systems since the received sample <span class="math notranslate nohighlight">\(z[n]\)</span> depends on multiple transmitted symbols <span class="math notranslate nohighlight">\(x[n]\)</span>.</p>
<p>If we stack <span class="math notranslate nohighlight">\(N\)</span> consecutive received samples into a column vector <span class="math notranslate nohighlight">\(\mathbf{z}\)</span>, we obtain the following compact matrix formulation:</p>
<div class="math notranslate nohighlight">
\[\mathbf{z} = \mathbf{H}\mathbf{x} + \mathbf{b}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{H}\)</span> is a <strong>Toeplitz convolution matrix</strong> constructed from the channel taps. For example, if <span class="math notranslate nohighlight">\(\mathbf{x} = [x[0], x[1], \dots, x[N-1]]^T\)</span>, then <span class="math notranslate nohighlight">\(\mathbf{H}\)</span> takes the form</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{H}=
\begin{bmatrix}
h[0]   &amp; 0      &amp; \cdots &amp; 0 \\
h[1]   &amp; h[0]   &amp; \ddots &amp; \vdots \\
h[2]   &amp; h[1]   &amp; \ddots &amp; \vdots \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
0      &amp; 0      &amp; \cdots &amp; h[L-1]
\end{bmatrix}\end{split}\]</div>
</section>
<section id="single-carrier-chain">
<h2>3. Single Carrier Chain<a class="headerlink" href="#single-carrier-chain" title="Link to this heading">#</a></h2>
<section id="signal-model">
<h3>Signal Model<a class="headerlink" href="#signal-model" title="Link to this heading">#</a></h3>
<p>Let’s build a basic SC simulation to illustrate the performance in a selective channel:</p>
<pre  class="mermaid">
        graph LR;
   A[Generator] --&gt; C[Mapper];
   C --&gt; D[Channel];
   D --&gt; E[AWGN];
   E --&gt; G[Equalizer];
   G --&gt; H[Demapper];
    </pre><p>At the receiver, the channel is compensated using a simple Zero-Forcing (ZF) equalizer:</p>
<div class="math notranslate nohighlight">
\[\widehat{\mathbf{x}} = \mathbf{H}^{\dagger}\mathbf{z}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{H}^{\dagger}\)</span> denotes the pseudo-inverse of the channel matrix.
Note that, due to the large number of transmitted samples, the implementation of more sophisticated detectors—such as the Maximum Likelihood (ML) detector—becomes computationally prohibitive.</p>
</section>
<section id="implementation">
<h3>Implementation<a class="headerlink" href="#implementation" title="Link to this heading">#</a></h3>
<p>In <strong>comnumpy</strong>, this communication chain can be conveniently implemented as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a simple single carrier chain and simulate</span>
<span class="n">simple_chain</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">([</span>
        <span class="n">SymbolGenerator</span><span class="p">(</span><span class="n">M</span><span class="p">),</span>
        <span class="n">Recorder</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;data_tx&quot;</span><span class="p">),</span>
        <span class="n">SymbolMapper</span><span class="p">(</span><span class="n">alphabet</span><span class="p">),</span>
        <span class="n">FIRChannel</span><span class="p">(</span><span class="n">h</span><span class="p">),</span>
        <span class="n">AWGN</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">sigma2</span><span class="p">),</span>
        <span class="n">Recorder</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;data_rx&quot;</span><span class="p">),</span>
        <span class="n">LinearEqualizer</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;zf&quot;</span><span class="p">),</span>
        <span class="n">Recorder</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;data_rx_eq&quot;</span><span class="p">),</span>
        <span class="n">SymbolDemapper</span><span class="p">(</span><span class="n">alphabet</span><span class="p">)</span>
    <span class="p">])</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">s_rx</span> <span class="o">=</span> <span class="n">simple_chain</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">stop_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="results">
<h3>Results<a class="headerlink" href="#results" title="Link to this heading">#</a></h3>
<p>To evaluate this communication chain, we can evaluate some detection metric (such as SER) and the computational complexity measured in terms of computational time. We can also plot the signal constellation before and after the equalizer to highlight the benefit of the ZF equalizer.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># extract signals, compute ser and elapsed time</span>
<span class="n">s_tx</span> <span class="o">=</span> <span class="n">simple_chain</span><span class="p">[</span><span class="s2">&quot;data_tx&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
<span class="n">ser</span> <span class="o">=</span> <span class="n">compute_ser</span><span class="p">(</span><span class="n">s_tx</span><span class="p">,</span> <span class="n">s_rx</span><span class="p">)</span>
<span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">stop_time</span> <span class="o">-</span> <span class="n">start_time</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SER: </span><span class="si">{</span><span class="n">ser</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;elapsed time: </span><span class="si">{</span><span class="n">elapsed_time</span><span class="si">}</span><span class="s2"> s&quot;</span><span class="p">)</span>

<span class="c1"># plot signal and save</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">indice</span><span class="p">,</span> <span class="n">processor_name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="s2">&quot;data_rx&quot;</span><span class="p">,</span> <span class="s2">&quot;data_rx_eq&quot;</span><span class="p">]):</span>
    <span class="n">data_rx</span> <span class="o">=</span> <span class="n">simple_chain</span><span class="p">[</span><span class="n">processor_name</span><span class="p">]</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">indice</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">data_rx</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">data_rx</span><span class="p">),</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">indice</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Received signal (</span><span class="si">{</span><span class="n">processor_name</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">indice</span><span class="p">]</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s2">&quot;box&quot;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">indice</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">indice</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>For the single-carrier chain, we obtain:</p>
<ul class="simple">
<li><p>A Symbol Error Rate (SER) equals to : 0.007</p></li>
<li><p>A total computational time equals to: 0.562s</p></li>
</ul>
<p>The following figures present the constellation of the the received signal before and after linear equalization.</p>
<img alt="../_images/one_shot_ofdm_fig1.png" src="../_images/one_shot_ofdm_fig1.png" />
</section>
</section>
<section id="ofdm-chain">
<h2>4. OFDM Chain<a class="headerlink" href="#ofdm-chain" title="Link to this heading">#</a></h2>
<p>In frequency-selective channels, the conventional single-carrier chain suffers from suboptimal detection performance and high computational complexity, mainly due to the need to invert a large matrix. A common solution to overcome this limitation is to employ an OFDM chain.</p>
<section id="id1">
<h3>Signal Model<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<pre  class="mermaid">
        graph LR;
   A[Generator] --&gt; B[Mapper];
   B --&gt; C[OFDM Tx];
   C --&gt; D[Channel];
   D --&gt; E[AWGN];
   E --&gt; G[OFDM Rx];
   G --&gt; H[Demapper];
    </pre><p>The OFDM transmitter and receiver can be decomposed as follows:</p>
<ul class="simple">
<li><p>OFDM TX:</p></li>
</ul>
<pre  class="mermaid">
        graph LR;
   A[Mapper] --&gt; B[S2P];
   B --&gt; C[IDFT];
   C --&gt; D[CP add];
   D --&gt; E[P2S];
   E --&gt; G[Channel];
    </pre><ul class="simple">
<li><p>OFDM RX:</p></li>
</ul>
<pre  class="mermaid">
        graph LR;
   A[Channel] --&gt; B[P2S];
   B --&gt; C[CP del];
   C --&gt; D[DFT];
   D --&gt; E[Equalizer];
   E --&gt; F[P2S];
    </pre><p>where</p>
<ul class="simple">
<li><p>S2P / P2S: Serial-to-Parallel and Parallel-to-Serial converters. S2P takes the incoming serial bitstream and splits it into :math:N_{sc} parallel symbol streams, while P2S performs the reverse operation.</p></li>
<li><p>IDFT / DFT: The Inverse Discrete Fourier Transform (TX) generates the time-domain OFDM signal from frequency-domain symbols. At the RX, the DFT transforms the received time-domain samples back into the frequency domain.</p></li>
<li><p>CP add / CP del: The Cyclic Prefix is appended at the transmitter to mitigate intersymbol interference caused by multipath. At the receiver, this prefix is removed before further processing.</p></li>
<li><p>Equalizer: Compensates for the distortions introduced by the channel (e.g. frequency-selective fading), restoring the original symbol constellation as closely as possible.</p></li>
</ul>
<p>The main advantage of this structure is that, before equalization, one can verify that the received vector can be written as</p>
<div class="math notranslate nohighlight">
\[\mathbf{z} = \mathbf{D}\mathbf{x} + \mathbf{n}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\mathbf{D} = \textrm{diag}\big(H[0],H[1],\dots,H[N-1]\big)\]</div>
<p>is a diagonal matrix, and</p>
<div class="math notranslate nohighlight">
\[H[k]=\sum_{l=0}^{L-1} h[l]e^{-j\frac{2\pi}{N}kl}\]</div>
<p>corresponds to the DFT of the channel impulse response.</p>
<p>In other words, an OFDM system transforms a frequency-selective channel into a bank of parallel flat-fading subchannels, each of which can be equalized independently with a simple one-tap detector (e.g., ML, ZF, or MMSE). This property follows from the cyclic prefix (CP): inserting and removing the CP turns linear convolution into circular convolution, which is diagonalized by the DFT/IDFT matrices. Note that the multiplication with DFT/IDFT matrices can be computed efficiently via the FFT/IFFT, allowing to drastically reduce the computational complexity.</p>
</section>
<section id="id2">
<h3>Implementation<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>We can easily simulate the OFDM communication chain using <strong>comnumpy</strong> as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">img_dir</span><span class="si">}</span><span class="s2">/one_shot_ofdm_fig1.png&quot;</span><span class="p">)</span>

<span class="c1"># create an OFDM chain and simulate</span>
<span class="n">N_carrier</span> <span class="o">=</span> <span class="mi">128</span>
<span class="n">N_cp</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">ofdm_chain</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">([</span>
        <span class="n">SymbolGenerator</span><span class="p">(</span><span class="n">M</span><span class="p">),</span>
        <span class="n">Recorder</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;data_tx&quot;</span><span class="p">),</span>
        <span class="n">SymbolMapper</span><span class="p">(</span><span class="n">alphabet</span><span class="p">),</span>
        <span class="n">OFDMTransmitter</span><span class="p">(</span><span class="n">N_carrier</span><span class="p">,</span> <span class="n">N_cp</span><span class="p">),</span>   <span class="c1"># &lt;- add OFDM transmitter</span>
        <span class="n">FIRChannel</span><span class="p">(</span><span class="n">h</span><span class="p">),</span>
        <span class="n">AWGN</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">sigma2</span><span class="p">),</span>
        <span class="n">OFDMReceiver</span><span class="p">(</span><span class="n">N_carrier</span><span class="p">,</span> <span class="n">N_cp</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="n">h</span><span class="p">),</span> <span class="c1"># &lt;- add OFDM receiver</span>
        <span class="n">Recorder</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;data_rx&quot;</span><span class="p">),</span>
        <span class="n">SymbolDemapper</span><span class="p">(</span><span class="n">alphabet</span><span class="p">)</span>
    <span class="p">])</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">s_rx</span> <span class="o">=</span> <span class="n">ofdm_chain</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="n">stop_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="id3">
<h3>Results<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># extract signals, compute ser and elapsed time</span>
<span class="n">s_tx</span> <span class="o">=</span> <span class="n">ofdm_chain</span><span class="p">[</span><span class="s2">&quot;data_tx&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[:</span><span class="n">N</span><span class="p">]</span>
<span class="n">data_rx</span> <span class="o">=</span> <span class="n">ofdm_chain</span><span class="p">[</span><span class="s2">&quot;data_rx&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[:</span><span class="n">N</span><span class="p">]</span>
<span class="n">ser</span> <span class="o">=</span> <span class="n">compute_ser</span><span class="p">(</span><span class="n">s_tx</span><span class="p">,</span> <span class="n">s_rx</span><span class="p">)</span>
<span class="n">elapsed_time</span> <span class="o">=</span> <span class="n">stop_time</span> <span class="o">-</span> <span class="n">start_time</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SER: </span><span class="si">{</span><span class="n">ser</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;elapsed time: </span><span class="si">{</span><span class="n">elapsed_time</span><span class="si">}</span><span class="s2"> s&quot;</span><span class="p">)</span>

<span class="c1"># plot signal and save</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">data_rx</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">data_rx</span><span class="p">),</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;OFDM Chain: received data (SER=</span><span class="si">{</span><span class="n">ser</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>For the OFDM chain, we obtain the following results:</p>
<ul class="simple">
<li><p>Symbol Error Rate (SER): 0.004 ( &lt; 0.007)</p></li>
<li><p>Total computational time: 0.007s ( &lt; 0.562s)</p></li>
</ul>
<p>Note that this substantial reduction in computational complexity stems from the fact that channel equalization reduces to the inversion of a diagonal matrix, while the OFDM transmitter and receiver rely on Fast Fourier Transform (FFT) algorithms. Concerning the Symbol Error Rate (SER), the improvement arises from the fact that, under Gaussian noise, the receiver uses a Maximum Likelihood detector under flat fading channels.</p>
<img alt="../_images/one_shot_ofdm_fig2.png" src="../_images/one_shot_ofdm_fig2.png" />
</section>
</section>
<section id="why-is-ofdm-more-robust">
<h2>Why is OFDM more robust?<a class="headerlink" href="#why-is-ofdm-more-robust" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>The FIR channel introduces frequency selectivity (some frequencies are attenuated more than others).</p></li>
<li><p>Single carrier systems suffer from ISI and frequency nulls.</p></li>
<li><p>OFDM spreads the information over multiple narrowband subcarriers. Each subcarrier experiences a flat channel (or close to flat), equalization becomes trivial (1 tap per subcarrier), and the cyclic prefix prevents ISI, as long as the prefix is longer than the channel.</p></li>
</ul>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h2>
<p>This tutorial highlighted:</p>
<ul class="simple">
<li><p>How to use comnumpy to simulate both SC and OFDM systems.</p></li>
<li><p>Why OFDM is well-suited for real-world channels.</p></li>
<li><p>How to assess system performance using SER and plots.</p></li>
</ul>
<p>By building modular processing chains and using the built-in blocks of comnumpy, you can quickly prototype and validate your ideas — whether you’re teaching, learning, or experimenting.</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="awgn.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">AWGN Chain Tutorial</p>
      </div>
    </a>
    <a class="right-next"
       href="ofdm_papr.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">PAPR in OFDM Communication</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites">Prerequisites</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulation-setup">Simulation Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">1. Import Libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-simulation-parameters">2. Define Simulation Parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#single-carrier-chain">3. Single Carrier Chain</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#signal-model">Signal Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implementation">Implementation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#results">Results</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ofdm-chain">4. OFDM Chain</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Signal Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Implementation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Results</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-is-ofdm-more-robust">Why is OFDM more robust?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/examples/ofdm.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, V. Choqueuse.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>