
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Optical Fiber Link Simulation Tutorial &#8212; comnumpy  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=119accc5" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/optical_fiber_nonlinearity';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Documentation" href="../documentation/index.html" />
    <link rel="prev" title="MIMO Chain Tutorial" href="mimo.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.jpg" class="logo__image only-light" alt=""/>
    <img src="../_static/logo.jpg" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">Comnumpy</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/index.html">
    Getting Started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../documentation/index.html">
    Documentation
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/vincentchoqueuse/comnumpy.git" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting_started/index.html">
    Getting Started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../documentation/index.html">
    Documentation
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/vincentchoqueuse/comnumpy.git" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="awgn.html">Monte Carlo Simulation over AWGN Channel</a></li>
<li class="toctree-l1"><a class="reference internal" href="ofdm.html">OFDM Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="ofdm_papr.html">PAPR in OFDM Communication</a></li>
<li class="toctree-l1"><a class="reference internal" href="mimo.html">MIMO Chain Tutorial</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Optical Fiber Link Simulation Tutorial</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Examples</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Optical Fiber Link Simulation Tutorial</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="optical-fiber-link-simulation-tutorial">
<h1>Optical Fiber Link Simulation Tutorial<a class="headerlink" href="#optical-fiber-link-simulation-tutorial" title="Link to this heading">#</a></h1>
<p>This tutorial demonstrates how to simulate a nonlinear optical fiber communication system using the <code class="docutils literal notranslate"><span class="pre">comnumpy</span></code> library. You will learn how to:</p>
<ul class="simple">
<li><p>Build a simulation chain with QAM modulation, pulse shaping, and fiber propagation.</p></li>
<li><p>Visualize received signals before and after linear and nonlinear equalization.</p></li>
<li><p>Apply digital back-propagation (DBP) for nonlinear compensation.</p></li>
<li><p>Compute Symbol Error Rate (SER) to quantify performance.</p></li>
</ul>
<p>This tutorial is ideal for engineers or students interested in optical communications and nonlinear fiber effects.</p>
<section id="introduction">
<h2>1. Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<section id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading">#</a></h3>
<p>Ensure you have the following Python libraries installed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">numpy</span>
<span class="n">matplotlib</span>
<span class="n">comnumpy</span>
</pre></div>
</div>
<p>Note that the simulation can be computationally intensive and may take some time to run depending on your machine.</p>
</section>
</section>
<section id="simulation-setup">
<h2>Simulation Setup<a class="headerlink" href="#simulation-setup" title="Link to this heading">#</a></h2>
</section>
<section id="import-libraries">
<h2>1. Import Libraries<a class="headerlink" href="#import-libraries" title="Link to this heading">#</a></h2>
<p>First, import necessary Python libraries and components from <code class="docutils literal notranslate"><span class="pre">comnumpy</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">comnumpy.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">Sequential</span><span class="p">,</span> <span class="n">Recorder</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">comnumpy.core.generators</span><span class="w"> </span><span class="kn">import</span> <span class="n">SymbolGenerator</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">comnumpy.core.mappers</span><span class="w"> </span><span class="kn">import</span> <span class="n">SymbolMapper</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">comnumpy.core.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_alphabet</span><span class="p">,</span> <span class="n">hard_projector</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">comnumpy.core.processors</span><span class="w"> </span><span class="kn">import</span> <span class="n">Upsampler</span><span class="p">,</span> <span class="n">Downsampler</span><span class="p">,</span> <span class="n">Amplifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">comnumpy.core.filters</span><span class="w"> </span><span class="kn">import</span> <span class="n">SRRCFilter</span><span class="p">,</span> <span class="n">BWFilter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">comnumpy.core.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">compute_ser</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">comnumpy.optical.links</span><span class="w"> </span><span class="kn">import</span> <span class="n">FiberLink</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">comnumpy.optical.dbp</span><span class="w"> </span><span class="kn">import</span> <span class="n">DBP</span>

<span class="n">img_dir</span> <span class="o">=</span> <span class="s2">&quot;../../docs/examples/img/&quot;</span>
</pre></div>
</div>
</section>
<section id="define-system-parameters">
<h2>2. Define System Parameters<a class="headerlink" href="#define-system-parameters" title="Link to this heading">#</a></h2>
<p>Set key parameters such as modulation order, oversampling factors, fiber link properties, and noise figure:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">modulation</span> <span class="o">=</span> <span class="s2">&quot;QAM&quot;</span>
<span class="n">alphabet</span> <span class="o">=</span> <span class="n">get_alphabet</span><span class="p">(</span><span class="n">modulation</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="n">N_s</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">9</span>  <span class="c1"># number of symbols</span>
<span class="n">oversampling_sim</span> <span class="o">=</span> <span class="mi">6</span>  <span class="c1"># number of samples/symbol for simulated channel</span>
<span class="n">oversampling_dsp</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># number of samples/symbol for dsp processing</span>
<span class="n">NF_dB</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># noise figure in dB</span>
<span class="n">rolloff</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">StPS</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">StPS_DBP</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">R_s</span> <span class="o">=</span> <span class="mf">10.7</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">9</span><span class="p">)</span>  <span class="c1"># baud rate</span>
<span class="n">L_span</span> <span class="o">=</span> <span class="mi">80</span>  <span class="c1"># in km</span>
<span class="n">N_span</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">dBm</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>

<span class="c1"># compute simulation parameter</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">N_s</span><span class="o">*</span><span class="n">oversampling_sim</span>   <span class="c1"># signal length in number of samples</span>
<span class="n">fs</span> <span class="o">=</span> <span class="n">R_s</span><span class="o">*</span><span class="n">oversampling_sim</span>
<span class="n">oversampling_ratio</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">oversampling_sim</span><span class="o">/</span><span class="n">oversampling_dsp</span><span class="p">)</span>
<span class="n">fs2</span> <span class="o">=</span> <span class="n">R_s</span><span class="o">*</span><span class="n">oversampling_dsp</span>
<span class="n">Po</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1e-3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mf">0.1</span><span class="o">*</span><span class="n">dBm</span><span class="p">))</span>
<span class="n">amp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Po</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="create-communication-chain">
<h2>3. Create Communication Chain<a class="headerlink" href="#create-communication-chain" title="Link to this heading">#</a></h2>
<p>Build a processing chain consisting of symbol generation, mapping, pulse shaping (SRRC filter), amplification, fiber propagation via <code class="docutils literal notranslate"><span class="pre">FiberLink</span></code>, and final filtering/downsampling:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a communication chain</span>
<span class="n">chain</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">([</span>
                <span class="n">SymbolGenerator</span><span class="p">(</span><span class="n">M</span><span class="p">),</span>
                <span class="n">Recorder</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;data_tx&quot;</span><span class="p">),</span>
                <span class="n">SymbolMapper</span><span class="p">(</span><span class="n">alphabet</span><span class="p">),</span>
                <span class="n">Recorder</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;signal_tx&quot;</span><span class="p">),</span>
                <span class="n">Upsampler</span><span class="p">(</span><span class="n">oversampling_sim</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">oversampling_sim</span><span class="p">)),</span>
                <span class="n">SRRCFilter</span><span class="p">(</span><span class="n">rolloff</span><span class="p">,</span> <span class="n">oversampling_sim</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;fft&quot;</span><span class="p">),</span>
                <span class="n">Amplifier</span><span class="p">(</span><span class="n">amp</span><span class="p">),</span>
                <span class="n">FiberLink</span><span class="p">(</span><span class="n">N_spans</span><span class="o">=</span><span class="n">N_span</span><span class="p">,</span> <span class="n">L_span</span><span class="o">=</span><span class="n">L_span</span><span class="p">,</span> <span class="n">StPS</span><span class="o">=</span><span class="n">StPS</span><span class="p">,</span> <span class="n">NF_dB</span><span class="o">=</span><span class="n">NF_dB</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;link&quot;</span><span class="p">),</span>
                <span class="n">BWFilter</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">oversampling_sim</span><span class="p">),</span>
                <span class="n">Downsampler</span><span class="p">(</span><span class="n">oversampling_ratio</span><span class="p">)</span>
                <span class="p">])</span>
</pre></div>
</div>
<p>This simulates the full transmission over an optical fiber with nonlinear effects and noise.</p>
<p>The optical channel (<code class="docutils literal notranslate"><span class="pre">Fiber_Link</span></code>) is modeled as a concatenation of multiple spans of standard single-mode fiber (SMF), denoted by <code class="docutils literal notranslate"><span class="pre">N_span</span></code>. Each span has a fixed length <code class="docutils literal notranslate"><span class="pre">L_span</span></code> (typically 80 km) and is followed by an Erbium-Doped Fiber Amplifier (EDFA) which compensates for the fiber loss and introduces amplified spontaneous emission noise (characterized by the noise figure <code class="docutils literal notranslate"><span class="pre">NF_dB</span></code>).</p>
<p>Within each fiber span, the signal undergoes chromatic dispersion as well as nonlinear Kerr effects (simulated using Split Step Fourier Method), which distort the signal amplitude and phase. This complex interplay between dispersion and nonlinearity significantly affects system performance and motivates the use of advanced digital signal processing techniques.</p>
</section>
<section id="run-simulation-and-extract-signals">
<h2>4. Run Simulation and Extract Signals<a class="headerlink" href="#run-simulation-and-extract-signals" title="Link to this heading">#</a></h2>
<p>Execute the chain to obtain the received signal. Extract transmitted data and signal for analysis. Then, plot the received constellation diagram to inspect signal quality at the receiver input.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># perform simulation</span>
<span class="n">y_rx</span> <span class="o">=</span> <span class="n">chain</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>

<span class="c1"># extract signal</span>
<span class="n">s_tx</span> <span class="o">=</span> <span class="n">chain</span><span class="p">[</span><span class="s2">&quot;data_tx&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
<span class="n">x_tx</span> <span class="o">=</span> <span class="n">chain</span><span class="p">[</span><span class="s2">&quot;signal_tx&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

<span class="c1"># plot signal</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">y_rx</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">y_rx</span><span class="p">),</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Received Signal (oversampling=</span><span class="si">{</span><span class="n">oversampling_dsp</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">dBm</span><span class="si">}</span><span class="s2">dBm)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">img_dir</span><span class="si">}</span><span class="s2">/one_shot_NLI_fig1.png&quot;</span><span class="p">)</span>

</pre></div>
</div>
</section>
<section id="visualize-received-signal">
<h2>5. Visualize Received Signal<a class="headerlink" href="#visualize-received-signal" title="Link to this heading">#</a></h2>
<a class="reference internal image-reference" href="../_images/one_shot_NLI_fig1.png"><img alt="../_images/one_shot_NLI_fig1.png" class="align-center" src="../_images/one_shot_NLI_fig1.png" style="width: 100%;" />
</a>
</section>
<section id="perform-linear-and-nonlinear-compensation">
<h2>6. Perform Linear and Nonlinear Compensation<a class="headerlink" href="#perform-linear-and-nonlinear-compensation" title="Link to this heading">#</a></h2>
<p>Apply two compensation strategies using Digital Back-Propagation (DBP):</p>
<ul class="simple">
<li><p>Linear equalization only : compensates for linear impairments such as chromatic dispersion and attenuation.</p></li>
<li><p>Nonlinear equalization with Digital Back Propagation (DBP): performs full Digital Back-Propagation (DBP), which mitigates nonlinear fiber effects by numerically inverting the propagation through the fiber using a reversed Split-Step Fourier Method..</p></li>
</ul>
<p>Note that after compensation, the received signal may experience a residual phase rotation. Therefore, for each compensation technique, phase correction is applied before computing the Symbol Error Rate (SER).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="c1"># perform compensation</span>
<span class="k">for</span> <span class="n">num_compensator</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">num_compensator</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">use_only_linear</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">technique_name</span> <span class="o">=</span> <span class="s2">&quot;linear equalization&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">use_only_linear</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">technique_name</span> <span class="o">=</span> <span class="s2">&quot;nonlinear equalization&quot;</span>

    <span class="n">receiver</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">([</span>
                    <span class="n">DBP</span><span class="p">(</span><span class="n">N_span</span><span class="p">,</span> <span class="n">L_span</span><span class="p">,</span> <span class="n">StPS_DBP</span><span class="p">,</span> <span class="n">step_type</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">use_only_linear</span><span class="o">=</span><span class="n">use_only_linear</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">fs</span><span class="o">/</span><span class="n">oversampling_ratio</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;dbp&quot;</span><span class="p">),</span>
                    <span class="n">SRRCFilter</span><span class="p">(</span><span class="n">rolloff</span><span class="p">,</span> <span class="n">oversampling_dsp</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;fft&quot;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">oversampling_dsp</span><span class="p">)),</span>
                    <span class="n">Downsampler</span><span class="p">(</span><span class="n">oversampling_dsp</span><span class="p">),</span>
                    <span class="n">Amplifier</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">amp</span><span class="p">),</span>
                    <span class="n">Recorder</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;signal_rx_compensated&quot;</span><span class="p">)</span>
            <span class="p">])</span>

    <span class="c1"># apply conventional chain</span>
    <span class="n">x_rx</span> <span class="o">=</span> <span class="n">receiver</span><span class="p">(</span><span class="n">y_rx</span><span class="p">)</span>

    <span class="c1"># perform phase correction and evaluate metric</span>
    <span class="n">theta_est</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">x_rx</span><span class="p">)</span><span class="o">*</span><span class="n">x_tx</span><span class="p">))</span>
    <span class="n">x_rx_phase_compensated</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">theta_est</span><span class="p">)</span> <span class="o">*</span> <span class="n">x_rx</span>
    <span class="n">s_rx</span> <span class="o">=</span> <span class="n">hard_projector</span><span class="p">(</span><span class="n">x_rx_phase_compensated</span><span class="p">,</span> <span class="n">alphabet</span><span class="p">)</span>
    <span class="n">ser</span> <span class="o">=</span> <span class="n">compute_ser</span><span class="p">(</span><span class="n">s_tx</span><span class="p">,</span> <span class="n">s_rx</span><span class="p">)</span>

    <span class="c1"># plot signal</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">x_rx</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">x_rx</span><span class="p">),</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;before phase correction&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">x_rx_phase_compensated</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">x_rx_phase_compensated</span><span class="p">),</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;after phase correction&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">technique_name</span><span class="si">}</span><span class="s2"> (SER=</span><span class="si">{</span><span class="n">ser</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/one_shot_NLI_fig2.png"><img alt="../_images/one_shot_NLI_fig2.png" class="align-center" src="../_images/one_shot_NLI_fig2.png" style="width: 100%;" />
</a>
<a class="reference internal image-reference" href="../_images/one_shot_NLI_fig3.png"><img alt="../_images/one_shot_NLI_fig3.png" class="align-center" src="../_images/one_shot_NLI_fig3.png" style="width: 100%;" />
</a>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h2>
<p>This tutorial showed how to:</p>
<ul class="simple">
<li><p>Model an optical fiber communication system with nonlinear effects.</p></li>
<li><p>Use SRRC filtering and oversampling to shape signals.</p></li>
<li><p>Simulate fiber propagation with noise and nonlinearities.</p></li>
<li><p>Apply linear and nonlinear compensation techniques (DBP).</p></li>
<li><p>Quantify performance improvements via SER metrics.</p></li>
</ul>
<p>The simulation provides valuable insights into advanced fiber-optic communication design and compensation methods using the <code class="docutils literal notranslate"><span class="pre">comnumpy</span></code> framework.</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="mimo.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">MIMO Chain Tutorial</p>
      </div>
    </a>
    <a class="right-next"
       href="../documentation/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Documentation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">1. Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites">Prerequisites</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simulation-setup">Simulation Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-libraries">1. Import Libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#define-system-parameters">2. Define System Parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-communication-chain">3. Create Communication Chain</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-simulation-and-extract-signals">4. Run Simulation and Extract Signals</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-received-signal">5. Visualize Received Signal</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#perform-linear-and-nonlinear-compensation">6. Perform Linear and Nonlinear Compensation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/examples/optical_fiber_nonlinearity.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      Â© Copyright 2025, V. Choqueuse.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>